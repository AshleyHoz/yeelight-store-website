{%- liquid
  assign specifications = section.settings.specifications | split: '/,/'
  assign show_image = section.settings.show_image | default: false
-%}
<div class="product-comparison-wrapper">
  <div class="product-comparison-table">
    <!-- Fixed first column -->
    <div class="fixed-column">
      {%- if show_image -%}
        <div class="header-cell d-flex align-center justify-center flex-column"></div>
      {%- endif -%}
      {% for specification in specifications %}
        <div class="spec-cell">
          {{ specification }}
        </div>
      {% endfor %}
    </div>

    <!-- Scrollable content -->
    <div class="scrollable-content">
      <div class="table-content">
        <!-- Header row with products -->
        {%- if show_image -%}
          <div class="header-row d-flex">
            {% for product in section.blocks %}
              <div class="product-header d-flex align-center justify-center flex-column">
                {% if product.settings.product_image %}
                  {%- render 'responsive-image', class: 'product-image', image: product.settings.product_image -%}
                {% endif %}
                {% if product.settings.model_name %}
                  <div class="model-name mt-2">{{ product.settings.model_name }}</div>
                {% endif %}
              </div>
            {% endfor %}
          </div>
        {%- endif -%}

        <!-- Specification rows -->
        {% for specification in specifications %}
          <div class="spec-row">
            {%- liquid
              assign specifications_index = forloop.index0
            -%}
            {% for product in section.blocks %}
              <div class="spec-value">
                {%- liquid
                  assign specifications_content = product.settings.specifications_content | split: '/,/'
                -%}
                {{ specifications_content[specifications_index] | default: '-' }}
              </div>
            {% endfor %}
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<style>
  .product-comparison-wrapper {
    background-color: {{ section.settings.background_color | default: '#1a1a1a' }};
    color: {{ section.settings.text_color | default: '#ffffff' }};
    padding: {{ section.settings.padding | default: '40px 20px' }};
    font-family: {{ section.settings.font_family | default: 'Arial, sans-serif' }};
  }

  .product-comparison-table {
    display: flex;
    max-width: 1440px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    margin: 0 auto;
  }

  .fixed-column {
    min-width: 200px;
    flex-shrink: 0;
  }

  .scrollable-content {
    flex: 1;
    overflow-x: auto;
    background-color: rgba(255, 255, 255, 0.02);
  }

  .table-content {
    min-width: max-content;
  }

  .header-cell,
  .product-header {
    height: 180px;
    padding: 20px;
    flex: 1;
  }

  .header-cell {
    display: flex;
    align-items: center;
  }

  .product-header {
    min-width: 180px;
  }

  .product-image,
  .product-image-placeholder {
    width: 120px;
    height: auto;
  }

  .product-image-placeholder {
    background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
    background-size: 400% 400%;
    animation: gradientShift 3s ease infinite;
  }

  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .product-image {
    object-fit: cover;
  }

  .model-name {
    font-size: 14px;
    font-weight: 600;
    text-align: center;
    color: {{ section.settings.model_text_color | default: '#ffffff' }};
  }

  .spec-row {
    display: flex;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    opacity: 0.6;
  }

  .spec-row:hover {
    background-color: rgba(255, 255, 255, 0.02);
    opacity: 1;
  }

  .spec-cell,
  .spec-value {
    padding: 20px 0;
    font-size: 14px;
    min-height: 50px;
    font-weight: 500;
    font-size: 20px;
    text-align: center;
    flex: 1;
    min-width: 250px;
  }

  .spec-cell {
    color: {{ section.settings.spec_label_color | default: '#cccccc' }};
  }

  .spec-value {
    justify-content: center;
    color: {{ section.settings.spec_value_color | default: '#ffffff' }};
    font-weight: 400;
  }

  /* Scrollbar styling */
  .scrollable-content::-webkit-scrollbar {
    height: 8px;
  }

  .scrollable-content::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
  }

  .scrollable-content::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
  }

  .scrollable-content::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.5);
  }

  /* Responsive design */
  @media (max-width: 768px) {
    .fixed-column {
      min-width: 150px;
    }

    .product-header,
    .spec-value {
      min-width: 140px;
    }

    .spec-cell,
    .spec-value {
      padding: 12px 15px;
      font-size: 13px;
    }

    .model-name {
      font-size: 12px;
    }
  }
</style>

{% schema %}
{
  "name": "Product Info Table",
  "tag": "section",
  "class": "product-info-table",
  "settings": [
    {
      "type": "header",
      "content": "Table Styling"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "model_text_color",
      "label": "Model Name Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "spec_label_color",
      "label": "Specification Label Color",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "spec_value_color",
      "label": "Specification Value Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "padding",
      "label": "Section Padding",
      "default": "40px 20px",
      "info": "CSS padding value (e.g., '40px 20px')"
    },
    {
      "type": "select",
      "id": "font_family",
      "label": "Font Family",
      "options": [
        {
          "value": "Arial, sans-serif",
          "label": "Arial"
        },
        {
          "value": "'Helvetica Neue', Helvetica, sans-serif",
          "label": "Helvetica"
        },
        {
          "value": "'Segoe UI', Tahoma, Geneva, sans-serif",
          "label": "Segoe UI"
        },
        {
          "value": "Georgia, serif",
          "label": "Georgia"
        }
      ],
      "default": "Arial, sans-serif"
    },
    {
      "type": "header",
      "content": "Specifications Configuration"
    },
    {
      "type": "textarea",
      "id": "specifications",
      "label": "Specifications (JSON)",
      "default": "Rated Power/,/Voltage/,/Lumens/,/Color Temperature/,/Beam Angle/,/Lifespan",
      "info": "Define specifications with 'name' properties, use '/,/' to separate these properties."
    },
    {
      "type": "checkbox",
      "id": "show_image",
      "label": "Show Product Image",
      "default": false,
      "info": "Enable this to show product images in the first column."
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product",
      "settings": [
        {
          "type": "text",
          "id": "model_name",
          "label": "Model Name",
          "default": "YLXDD-0270"
        },
        {
          "type": "image_picker",
          "id": "product_image",
          "label": "Product Image"
        },
        {
          "type": "text",
          "id": "specifications_content",
          "label": "Product Specifications Content",
          "default": "0"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Product Info Table",
      "blocks": [
        {
          "type": "product",
          "settings": {
            "model_name": "YLXDD-0270",
            "specifications_content": "0"
          }
        },
        {
          "type": "product",
          "settings": {
            "model_name": "YLXDD-0271",
            "specifications_content": "1"
          }
        },
        {
          "type": "product",
          "settings": {
            "model_name": "YLXDD-0272",
            "specifications_content": "2"
          }
        },
        {
          "type": "product",
          "settings": {
            "model_name": "YLXDD-0273",
            "specifications_content": "3"
          }
        }
      ]
    }
  ]
}
{% endschema %}
