{%- liquid
  assign is_purchasable = false
  if product_small.available and product_small.variants.size == 1
    assign is_purchasable = true
  endif
-%}
<product-card-small
  class="product-card-small quick-add-to-card--{{ is_purchasable }}"
  data-url="{{ product_small.url }}"
  data-id="{{ product_small.selected_or_first_available_variant.id }}"
  data-product-handle="{{ product_small.handle }}"
>
  <div class="product-card-small--image">
    <a href="{{ product_small.url }}" title="{{ product_small.title | escape }}" class="product-cart-small--image-link">
      {% if product_small.featured_image %}
        {%- render 'responsive-image', image: product_small.featured_image, sizes: '200x0' -%}
      {% else %}
        <div class="thb-placeholder" style="width: 70px; height:80px;">
          {%- liquid
            capture index
              cycle '1', '2', '3', '4', '5', '6'
            endcapture
          -%}
          {{ 'product-' | append: index | placeholder_svg_tag }}
        </div>
      {% endif %}
    </a>
  </div>
  <div class="product-card-small--info">
    {%- liquid
      assign product_title = product_small.title
      if predictive_search
        assign product_title = product_title | highlight: predictive_search.terms
      endif
    -%}
    <a href="{{ product_small.url }}" title="{{ product_small.title | escape }}" class="product-card-small--link">
      {{- product_title -}}
    </a>
    <div class="product-card-small--add-to-cart">
      {% render 'product-price', product: product_small %}
      {% if is_purchasable %}
        <button class="product-card-small--add-to-cart-button">
          <span class="product-card-small--add-to-cart-icon">
            {%- render 'svg-icons' with 'thb-add-to-cart' -%}
            <span class="loading-overlay">{% render 'svg-icons' with 'thb-loading' %}</span></span
          >
          <span class="product-card-small--add-to-cart-text">{{ 'products.product.add_to_cart' | t }}</span>
        </button>
      {% else %}
        <quick-view class="product-card-small--add-to-cart-button" data-product-handle="{{ product_small.handle }}"
          ><span class="product-card-small--add-to-cart-icon">
            {%- render 'svg-icons' with 'thb-add-to-cart' -%}
            <span class="loading-overlay">{% render 'svg-icons' with 'thb-loading' %}</span></span
          >
          <span class="product-card-small--add-to-cart-text">
            {{ 'products.product.choose_options' | t -}}
          </span>
        </quick-view>
      {% endif %}
    </div>
    <div class="product-card-small--info-add-to-cart">
      {% if is_purchasable == false %}
        {% assign variant = product_small.variants[0] %}
        {{ variant.title }}
      {% endif %}

      {% comment %}
        <select name="id">
          {% for variant in product_small.variants %}
            <option
              value="{{ variant.id }}"
              {% if forloop.first %}
                selected
              {% endif %}
            >
              {{ variant.title }}
            </option>
          {% endfor %}
        </select>
      {% endcomment %}
      <div class="product-card-small--info-cart-price">
        {% comment %} {% render 'product-price', product: product_small %} {% endcomment %}
        {{ product_small.selected_or_first_available_variant.price | money }}
        {{ product_small.price | money }}
        {{ product_small.selected_or_first_available_variant.compare_at_price | money }}
        {{ product_small.compare_at_price | money }}
        {{ product_small.selected_or_first_available_variant.unit_price | money }}
        {{ product_small.unit_price | money }}
        {% comment %}
          <div class="product-price">
            {{ product_small.variants.first.price | money }}
            <span class="product-line-price">
              {%- if product_small.original_line_price != product_small.final_line_price -%}
                <del
                  ><span class="amount">{{ product_small.original_line_price | money }}</span></del
                >
                <ins
                  ><span class="amount">{{ product_small.final_line_price | money }}</span></ins
                >
              {%- else -%}
                <ins
                  ><span class="amount">{{ product_small.original_line_price | money }}</span></ins
                >
              {%- endif -%}
            </span>
            <span class="price">
              {%- if product_smalloriginal_line_price != product_smallfinal_line_price -%}
                <del
                  ><span class="amount custom-amount-del">{{ product_smalloriginal_line_price | money }}</span></del
                >
                <ins
                  ><span class="amount custom-amount-ins">{{ product_smallfinal_line_price | money }}</span></ins
                >
              {%- else -%}
                <ins
                  ><span class="amount custom-amount-ins">{{ product_smalloriginal_line_price | money }}</span></ins
                >
              {%- endif -%}
              {%- if product_smallvariant.available and product_smallunit_price_measurement -%}
                <small class="unit-price">
                  {{ product_smallvariant.unit_price | money }}
                  <span class="unit-price-separator">/</span>
                  {%- if product_smallvariant.unit_price_measurement.reference_value != 1 -%}
                    {{- product_smallvariant.unit_price_measurement.reference_value -}}
                  {%- endif -%}
                  {{ product_smallvariant.unit_price_measurement.reference_unit }}
                </small>
              {%- endif -%}
            </span>
          </div>
        {% endcomment %}
        <button
          type="submit"
          name="add"
          id="AddToCart"
          class="single-add-to-cart-button button accent  single-add-to-cart-halloween"
          data-product="{{product_small}}"
          data-id="{{product_small.variants.first.id}}"
          data-product-id="{{product_small.selected_or_first_available_variant.id}}"
          onclick="addCart"
        >
          {{ 'products.product.add_to_cart' | t }}
        </button>
      </div>
    </div>
  </div>
</product-card-small>
